/* ==================== FIIRE SHARED STYLES ==================== */

/* Base */
body { font-family: 'Space Grotesk', system-ui, sans-serif; background: #1A1A1A; color: #D4D4D4; font-size: 12px; line-height: 1.4; zoom: 1.25; }
::-webkit-scrollbar { width: 4px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: #3D3D3D; border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: #4A4A4A; }
.glass-effect { background-color: #232323; }
.page { display: none; }
.page.active { display: flex; }
.fill-1 { font-variation-settings: 'FILL' 1; }

/* Subtle rounding on interactive elements */
button, a.inline-flex, [type="text"], [type="password"], [type="number"], select, .modal-overlay > div { border-radius: 3px; }
aside.w-\[200px\] { transition: margin-left 0.2s ease, opacity 0.2s ease; }
.nav-link { transition: all 0.1s; }
.nav-link:hover { background: #2D2D2D; }
.nav-link.active { background: rgba(232, 80, 2, 0.08); color: #E85002; }

/* Toast */
.toast {
  position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%);
  background: #E85002; color: #FFF;
  padding: 6px 16px; border-radius: 3px;
  font-size: 11px; font-weight: 600; z-index: 100; opacity: 0;
  transition: opacity 0.15s; pointer-events: none;
}
.toast.show { opacity: 1; }

/* Modal */
.modal-overlay {
  display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6);
  z-index: 60; align-items: center; justify-content: center;
}
.modal-overlay.open { display: flex; }

/* Animations */
@keyframes fadeIn { from { opacity: 0; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }
.animate-fadeIn { animation: fadeIn 0.15s ease-out; }
@keyframes slideUp { from { transform: translateY(100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
@keyframes waveformPulse {
  0%, 100% { opacity: 0.3; transform: scaleY(0.4); }
  50% { opacity: 1; transform: scaleY(1); }
}
@keyframes pulseGlow {
  0%, 100% { box-shadow: 0 0 0 0 rgba(232, 80, 2, 0.2); }
  50% { box-shadow: 0 0 8px 2px rgba(232, 80, 2, 0.1); }
}

/* Parameter chips */
.param-chip {
  padding: 2px 8px; border-radius: 3px; font-size: 10px; font-weight: 600;
  border: 1px solid #3D3D3D; background: #2D2D2D; color: #999;
  cursor: pointer; transition: all 0.1s; white-space: nowrap;
  text-transform: uppercase; letter-spacing: 0.04em;
}
.param-chip:hover { border-color: #4A4A4A; color: #D4D4D4; }
.param-chip.active { background: rgba(232, 80, 2, 0.1); border-color: #E85002; color: #E85002; }

/* Variation cards */
.variation-card { transition: all 0.1s ease; }
.variation-card:hover { background: #2D2D2D; }
.variation-card.kept { border-left: 2px solid rgba(16, 185, 129, 0.5); background: rgba(16, 185, 129, 0.03); }
.variation-card.skipped canvas { filter: grayscale(0.8); }
.variation-card.playing { background: rgba(232, 80, 2, 0.06); }

/* Sample cards */
.sample-card { transition: all 0.1s ease; cursor: grab; }
.sample-card:active { cursor: grabbing; }
.sample-card:hover { border-color: #4A4A4A; }
.sample-card.selected { border-color: #E85002; background: rgba(232, 80, 2, 0.04); }

/* Range sliders */
.range-slider { -webkit-appearance: none; appearance: none; height: 3px; background: #3D3D3D; border-radius: 3px; outline: none; }
.range-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 10px; height: 10px; background: #E85002; border-radius: 3px; cursor: pointer; border: none; }

/* Type badges */
.badge-loop { background: rgba(232, 80, 2, 0.12); color: #E85002; }
.badge-oneshot { background: rgba(59, 130, 246, 0.12); color: #3B82F6; }

/* Batch bar */
.batch-bar { animation: slideUp 0.2s ease-out; }

/* Generation loading */
.gen-loading-bar {
  width: 2px; height: 16px; border-radius: 3px; background: #E85002;
  display: inline-block; margin: 0 1px;
  animation: waveformPulse 1.2s ease-in-out infinite;
}
.gen-loading-bar:nth-child(2) { animation-delay: 0.1s; }
.gen-loading-bar:nth-child(3) { animation-delay: 0.2s; }
.gen-loading-bar:nth-child(4) { animation-delay: 0.3s; }
.gen-loading-bar:nth-child(5) { animation-delay: 0.4s; }
.gen-loading-bar:nth-child(6) { animation-delay: 0.5s; }

/* Base sample slots */
.base-slot {
  width: 140px; min-width: 140px; height: 100%;
  background: #2D2D2D; border: 1px solid #3D3D3D; border-radius: 3px;
  transition: all 0.1s; cursor: pointer; position: relative;
  display: flex; flex-direction: column; overflow: hidden; flex-shrink: 0;
}
.base-slot:hover { border-color: #4A4A4A; }
.base-slot.loaded { border-color: #4A4A4A; }
.base-slot.empty { border-style: dashed; }
.base-slot.empty:hover { border-color: #E85002; background: rgba(232, 80, 2, 0.03); }
.base-slot.generating { border-color: #E85002; animation: pulseGlow 2s ease-in-out infinite; }
.base-slot.drag-over { border-color: #E85002; background: rgba(232, 80, 2, 0.08); }
.base-slot .slot-waveform { flex: 1; min-height: 0; }
.base-slot .slot-meta {
  padding: 4px 6px; border-top: 1px solid #3D3D3D;
  font-size: 9px; font-weight: 600;
}
.base-slot .slot-actions {
  position: absolute; top: 2px; right: 2px;
  display: none; gap: 1px;
}
.base-slot:hover .slot-actions { display: flex; }

/* Sample bar slots */
.bar-slot {
  width: 36px; height: 36px; flex-shrink: 0;
  background: #2D2D2D; border: 1px solid #3D3D3D; border-radius: 3px;
  transition: all 0.1s; cursor: grab; position: relative;
  display: flex; align-items: center; justify-content: center; overflow: hidden;
}
.bar-slot:active { cursor: grabbing; }
.bar-slot:hover { border-color: #4A4A4A; }
.bar-slot.playing { border-color: #E85002; background: rgba(232, 80, 2, 0.08); }
.bar-slot canvas { width: 100%; height: 100%; }

/* Resize handle */
.resize-handle-h {
  height: 4px; cursor: ns-resize; background: transparent;
  position: relative; z-index: 5; transition: background 0.15s; flex-shrink: 0;
}
.resize-handle-h:hover, .resize-handle-h.active { background: rgba(232, 80, 2, 0.3); }

/* Track headers */
.track-header {
  height: 60px; border-bottom: 1px solid #3D3D3D;
  padding: 4px 8px; display: flex; flex-direction: column;
  justify-content: center; transition: background 0.1s;
}
.track-header:hover { background: #2D2D2D; }
.track-header .track-name {
  font-size: 11px; font-weight: 600; color: #D4D4D4;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  background: transparent; border: none; padding: 0; width: 100%;
  font-family: 'Space Grotesk', system-ui, sans-serif;
}
.track-header .track-name:focus { outline: none; color: #E85002; }
.track-header .track-controls { display: flex; align-items: center; gap: 4px; margin-top: 2px; }
.track-ctrl-btn {
  font-size: 9px; font-weight: 700; padding: 1px 4px;
  background: transparent; border: 1px solid #3D3D3D; border-radius: 3px;
  color: #666; cursor: pointer; transition: all 0.1s;
}
.track-ctrl-btn:hover { border-color: #4A4A4A; color: #999; }
.track-ctrl-btn.active-mute { color: #EF4444; border-color: #EF4444; background: rgba(239, 68, 68, 0.08); }
.track-ctrl-btn.active-solo { color: #FBBF24; border-color: #FBBF24; background: rgba(251, 191, 36, 0.08); }

/* Track lanes */
.track-lane {
  height: 60px; position: relative;
  border-bottom: 1px solid #2D2D2D;
}

/* Timeline blocks */
.tl-block {
  position: absolute; height: calc(100% - 4px); top: 2px;
  background: rgba(232, 80, 2, 0.12); border: 1px solid rgba(232, 80, 2, 0.35);
  border-radius: 3px; cursor: grab; transition: border-color 0.1s;
  display: flex; align-items: center; overflow: hidden;
}
.tl-block:hover { border-color: #E85002; }
.tl-block:active { cursor: grabbing; }
.tl-block.selected {
  border-color: #E85002; box-shadow: 0 0 8px rgba(232, 80, 2, 0.2);
}
.tl-block .block-label {
  font-size: 9px; font-weight: 600; color: #D4D4D4;
  padding: 0 4px; white-space: nowrap; overflow: hidden;
  text-overflow: ellipsis; position: absolute; top: 1px; left: 2px;
}
.tl-block .block-resize {
  position: absolute; top: 0; bottom: 0; width: 6px;
  cursor: ew-resize; z-index: 2;
}
.tl-block .block-resize.left { left: 0; }
.tl-block .block-resize.right { right: 0; }
.tl-block canvas { width: 100%; height: 100%; }

/* Playhead */
#playhead::before {
  content: ''; position: absolute; top: -6px; left: -4px;
  width: 0; height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 6px solid #E85002;
}

/* Drop indicator */
.drop-indicator {
  position: absolute; background: #E85002; opacity: 0.5;
  pointer-events: none; z-index: 15; width: 2px;
}

/* Drag ghost */
.drag-ghost {
  position: fixed; pointer-events: none; z-index: 100;
  background: rgba(232, 80, 2, 0.2); border: 1px solid #E85002;
  padding: 2px 8px; font-size: 10px; font-weight: 600; color: #E85002;
  border-radius: 3px;
}

/* Inline gen panel */
#inline-gen-panel {
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
  border-radius: 3px;
}

/* Transport buttons */
.transport-btn {
  background: #2D2D2D; border: 1px solid #3D3D3D; border-radius: 3px;
  transition: all 0.1s;
}
.transport-btn:hover { border-color: #4A4A4A; background: #333; }
.transport-btn:active { transform: translateY(1px); }

/* Track volume slider (mini) */
.track-vol {
  -webkit-appearance: none; appearance: none;
  height: 2px; background: #3D3D3D; border-radius: 3px; outline: none; width: 48px;
}
.track-vol::-webkit-slider-thumb {
  -webkit-appearance: none; width: 8px; height: 8px;
  background: #D4D4D4; border-radius: 3px; cursor: pointer; border: none;
}

/* Track pan slider (mini) */
.track-pan {
  -webkit-appearance: none; appearance: none;
  height: 2px; background: #3D3D3D; border-radius: 3px; outline: none; width: 32px;
}
.track-pan::-webkit-slider-thumb {
  -webkit-appearance: none; width: 6px; height: 6px;
  background: #D4D4D4; border-radius: 3px; cursor: pointer; border: none;
}

/* Per-track meter */
.track-meter {
  position: relative; width: 36px; height: 4px;
  background: #1A1A1A; border-radius: 1px; overflow: hidden; flex-shrink: 0;
}
.meter-fill {
  height: 100%; width: 0; background: linear-gradient(to right, #22C55E, #EAB308, #EF4444);
  border-radius: 1px; transition: width 0.05s linear;
}
.meter-fill.meter-clip { background: #EF4444; }
.meter-peak {
  position: absolute; top: 0; width: 1px; height: 100%;
  background: #FFF; transition: left 0.1s linear;
}

/* Master stereo meter */
.master-meter-bar {
  width: 3px; height: 20px; background: #1A1A1A; border-radius: 1px;
  position: relative; overflow: hidden;
}
.master-meter-fill {
  position: absolute; bottom: 0; width: 100%; height: 0;
  background: linear-gradient(to top, #22C55E, #EAB308, #EF4444);
  transition: height 0.05s linear;
}

/* Block context menu */
.block-context-menu {
  position: fixed; z-index: 60; background: #232323; border: 1px solid #3D3D3D;
  border-radius: 3px; padding: 8px; min-width: 200px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.5); font-size: 10px;
}
.ctx-header { font-weight: 700; color: #D4D4D4; margin-bottom: 6px; font-size: 11px; }
.ctx-row { display: flex; align-items: center; gap: 6px; padding: 2px 0; color: #999; }
.ctx-row span:first-child { width: 50px; flex-shrink: 0; }
.ctx-row input[type="range"] { flex: 1; height: 2px; }
.ctx-val { width: 38px; text-align: right; font-family: 'SF Mono', monospace; color: #D4D4D4; font-size: 9px; }
.ctx-divider { height: 1px; background: #3D3D3D; margin: 4px 0; }
.ctx-action {
  display: block; width: 100%; text-align: left; padding: 4px 6px;
  background: transparent; border: none; color: #999; cursor: pointer;
  font-size: 10px; border-radius: 2px;
}
.ctx-action:hover { background: #2D2D2D; color: #D4D4D4; }
.ctx-danger:hover { color: #EF4444; }

/* FX Panel */
.fx-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 8px 10px; border-bottom: 1px solid #3D3D3D;
}
.fx-section { padding: 8px 10px; border-bottom: 1px solid #2D2D2D; }
.fx-section-head { margin-bottom: 6px; }
.fx-row { display: flex; align-items: center; gap: 6px; padding: 2px 0; color: #999; font-size: 10px; }
.fx-row span:first-child { width: 44px; flex-shrink: 0; }
.fx-row input[type="range"] { flex: 1; height: 2px; }
.fx-val { width: 42px; text-align: right; font-family: 'SF Mono', monospace; color: #D4D4D4; font-size: 9px; }

/* Recording */
#tl-record.recording {
  animation: recordPulse 1s ease-in-out infinite;
  border-color: #EF4444; background: rgba(239, 68, 68, 0.1);
}
@keyframes recordPulse {
  0%, 100% { box-shadow: none; }
  50% { box-shadow: 0 0 8px rgba(239, 68, 68, 0.4); }
}
.record-armed { border-color: #EF4444 !important; color: #EF4444 !important; }

/* Fade overlay on blocks */
.block-fade-in, .block-fade-out {
  position: absolute; top: 0; height: 100%;
  background: linear-gradient(to right, rgba(26,26,26,0.7), transparent);
  pointer-events: none;
}
.block-fade-out {
  right: 0;
  background: linear-gradient(to left, rgba(26,26,26,0.7), transparent);
}

/* LCD display */
.lcd { background: #1A1A1A; border: 1px solid #3D3D3D; border-radius: 3px; font-family: 'SF Mono', 'Consolas', monospace; }

/* Timeline grid lines (drawn on canvas, but lane bg) */
.track-lane:nth-child(even) { background: rgba(45, 45, 45, 0.3); }

/* BPM input */
input[type="number"]::-webkit-inner-spin-button { opacity: 1; }

/* Ableton-style utilities */
.section-label { font-size: 9px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.08em; color: #666; }
.ab-input { background: #1A1A1A; border: 1px solid #3D3D3D; border-radius: 3px; font-size: 11px; padding: 2px 6px; color: #D4D4D4; font-family: 'SF Mono', 'Consolas', monospace; }
#lib-search { border-radius: 999px !important; padding: 3px 12px 3px 30px !important; background: #1A1A1A !important; border: 1px solid #3D3D3D !important; font-size: 11px; color: #D4D4D4; }
.ab-input:focus { border-color: #E85002; outline: none; }
.ab-select { background: #1A1A1A; border: 1px solid #3D3D3D; border-radius: 3px; font-size: 11px; padding: 2px 4px; color: #D4D4D4; }
.ab-select:focus { border-color: #E85002; outline: none; }
.no-scrollbar::-webkit-scrollbar { display: none; }
.no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

/* Filter popover */
.filter-popover-wrap { position: relative; }
.filter-popover {
  display: none; position: absolute; top: calc(100% + 4px); right: 0; z-index: 40;
  background: #232323; border: 1px solid #3D3D3D; border-radius: 3px;
  padding: 8px 10px; min-width: 180px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.4);
  animation: fadeIn 0.1s ease-out;
}
.filter-popover.open { display: flex; flex-direction: column; gap: 6px; }
.filter-popover label { font-size: 9px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.08em; color: #666; }
.filter-popover select { width: 100%; }
.filter-dot {
  position: absolute; top: 2px; right: 2px;
  width: 5px; height: 5px; border-radius: 50%;
  background: #E85002; display: none;
}
.filter-dot.active { display: block; }

/* Sound DNA */
.dna-drop-active { border-color: #E85002 !important; background: rgba(232, 80, 2, 0.05); }
.dna-bar { height: 6px; border-radius: 3px; background: #3D3D3D; overflow: hidden; }
.dna-bar-fill { height: 100%; border-radius: 3px; background: #E85002; transition: width 0.6s ease; }
.dna-char-slider {
  -webkit-appearance: none; appearance: none;
  height: 4px; border-radius: 3px; outline: none; width: 100%;
  background: linear-gradient(to right, #E85002 50%, #3D3D3D 50%);
  transition: background 0.05s;
}
.dna-char-slider::-webkit-slider-thumb {
  -webkit-appearance: none; width: 12px; height: 12px;
  background: #E85002; border-radius: 50%; cursor: pointer; border: 2px solid #232323;
  box-shadow: 0 0 0 1px rgba(232, 80, 2, 0.3);
  transition: box-shadow 0.1s;
}
.dna-char-slider::-webkit-slider-thumb:hover {
  background: #F16001;
  box-shadow: 0 0 0 3px rgba(232, 80, 2, 0.15);
}
.dna-char-slider:active::-webkit-slider-thumb {
  box-shadow: 0 0 0 4px rgba(232, 80, 2, 0.2);
}
.dna-stat-card {
  background: #1A1A1A; border: 1px solid #2D2D2D; border-radius: 3px;
  padding: 10px 12px; transition: border-color 0.1s;
}
.dna-stat-card:hover { border-color: #3D3D3D; }
.dna-track-item { animation: fadeIn 0.15s ease-out; }
.dna-analyzing { animation: pulseGlow 2s ease-in-out infinite; }

/* Blaise chat bubble */
.blaise-bubble {
  position: fixed; bottom: 16px; right: 16px; z-index: 55;
  width: 44px; height: 44px;
  background: #E85002; color: #FFF;
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  cursor: pointer; transition: all 0.15s;
  box-shadow: 0 2px 12px rgba(232, 80, 2, 0.3);
}
.blaise-bubble:hover { background: #F16001; transform: scale(1.05); }
.blaise-bubble.open { opacity: 0; pointer-events: none; transform: scale(0.8); }

.blaise-panel {
  position: fixed; bottom: 16px; right: 16px; z-index: 55;
  width: 350px; height: 460px;
  min-width: 280px; min-height: 300px;
  background: #232323; border: 1px solid #3D3D3D; border-radius: 3px;
  display: flex; flex-direction: column;
  opacity: 0; pointer-events: none;
  transform: translateY(12px) scale(0.95);
  transition: all 0.15s ease-out;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  resize: both; overflow: hidden;
}
.blaise-panel::-webkit-resizable { display: none; }
.blaise-resize-handle {
  position: absolute; top: 0; left: 0; width: 14px; height: 14px; cursor: nw-resize; z-index: 2;
}
.blaise-resize-handle::after {
  content: ''; position: absolute; top: 2px; left: 2px;
  width: 8px; height: 8px;
  border-top: 2px solid #666; border-left: 2px solid #666;
  opacity: 0; transition: opacity 0.15s;
}
.blaise-panel:hover .blaise-resize-handle::after { opacity: 1; }
.blaise-panel.open {
  opacity: 1; pointer-events: auto;
  transform: translateY(0) scale(1);
}
